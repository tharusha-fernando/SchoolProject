<!--
=========================================================
* Material Dashboard 2 - v3.0.0
=========================================================

* Product Page: https://www.creative-tim.com/product/material-dashboard
* Copyright 2021 Creative Tim (https://www.creative-tim.com) & UPDIVISION (https://www.updivision.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by www.creative-tim.com & www.updivision.com

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
@props(['bodyClass'])
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="apple-touch-icon" sizes="76x76" href="{{ asset('assets') }}/img/apple-icon.png">
    <link rel="icon" type="image/png" href="{{ asset('assets') }}/img/favicon.png">
    <title>
        Material Dashboard 2 by Creative Tim & UPDIVISION
    </title>
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
    <!-- Nucleo Icons -->
    <link href="{{ asset('assets') }}/css/nucleo-icons.css" rel="stylesheet" />
    <link href="{{ asset('assets') }}/css/nucleo-svg.css" rel="stylesheet" />
    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- CSS Files -->
    <link id="pagestyle" href="{{ asset('assets') }}/css/material-dashboard.css?v=3.0.0" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"
        integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css" />

    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>

    <style>
        #loading-spinner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            display: none;
        }

        #loading-spinner .spinner {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>

</head>

<body class="{{ $bodyClass }}">
    <div id="loading-spinner" class="text-center">
        <div class="spinner"></div>
    </div>


    {{ $slot }}

    <script src="{{ asset('assets') }}/js/core/popper.min.js"></script>
    <script src="{{ asset('assets') }}/js/core/bootstrap.min.js"></script>
    <script src="{{ asset('assets') }}/js/plugins/perfect-scrollbar.min.js"></script>
    <script src="{{ asset('assets') }}/js/plugins/smooth-scrollbar.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@flasher/flasher@1.2.4/dist/flasher.min.js"></script>

    @stack('js')
    <script>
        var win = navigator.platform.indexOf('Win') > -1;
        if (win && document.querySelector('#sidenav-scrollbar')) {
            var options = {
                damping: '0.5'
            }
            Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
        }

        function submitForm(action, method, formData) {
            $.ajax({
                url: action,
                type: method,
                data: formData,
                dataType: 'json',
                beforeSend: function() {
                    showLoading();
                },
                success: function(response, status, xhr) {
                    if (xhr.status === 200) {
                        flasher.success(response.message);
                        // if (table) {
                        //     table.ajax.reload();
                        // }
                        // if (modal) {
                        //     $(modal).modal("hide");
                        // }

                    } else if (xhr.status === 204) {
                        flasher.warning('Please make any changes.');

                    } else if (xhr.status === 205) {
                        flasher.error(response.message);

                    } else {
                        flasher.error("Internal server error.");
                    }
                },
                error: function(xhr) {
                    if (xhr.status === 422) {
                        var errors = xhr.responseJSON.errors;
                        displayValidationErrors(errors);
                    } else {
                        flasher.error("Internal Server Error.");
                    }
                },
                complete: function() {
                    hideLoading();
                }
            });



        }


        function showLoading(desc = '') {
            var spinner = $('#loading-spinner');
            $('#loading-spinner .backdrop-desc').html(desc);
            spinner.show();
        }

        function hideLoading() {
            var spinner = $('#loading-spinner');
            $('#loading-spinner .backdrop-desc').html('');
            spinner.hide();
        }

        function displayValidationErrors(errors) {
            $.each(errors, function(key, value) {
                var error = '';
                $.each(value, function(index, errorMessage) {
                    error = error + errorMessage + ' '
                });
                $(".error_" + key).text(error);
                $(".error_" + key).closest('.form-group').addClass(
                    'border--red');
            });
        }


        function deleteData(url, table = null,id=null) {
            $.ajax({
                url: url,
                type: 'DELETE',
                // type: 'DELETE',
                data: {
                    'id': id,
                    '_token': '{{ csrf_token() }}',
                },
                // headers: {
                //     'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                // },
                beforeSend: function() {
                    showLoading();
                },
                success: function(response, status, xhr) {
                    if (xhr.status === 200) {
                        flasher.success(response.message);
                        if (table) {
                            table.ajax.reload();
                        }
                    } else if (xhr.status === 203) {
                        flasher.warning('You cannot change logged user details.');
                    } else {
                        flasher.error("Internal server error.");
                    }
                },
                error: function(xhr) {
                    flasher.error("Internal Server Error.");
                },
                complete: function() {
                    hideLoading();
                }
            });
        }

        function addCourse(url, table = null,id=null) {
            $.ajax({
                url: url,
                type: 'POST',
                // type: 'DELETE',
                data: {
                    'id': id,
                    '_token': '{{ csrf_token() }}',
                },
                // headers: {
                //     'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                // },
                beforeSend: function() {
                    showLoading();
                },
                success: function(response, status, xhr) {
                    if (xhr.status === 200) {
                        flasher.success(response.message);
                        if (table) {
                            table.ajax.reload();
                        }
                    } else if (xhr.status === 203) {
                        flasher.warning('You cannot change logged user details.');
                    } else {
                        flasher.error("Internal server error.");
                    }
                },
                error: function(xhr) {
                    flasher.error("Internal Server Error.");
                },
                complete: function() {
                    hideLoading();
                }
            });
        }



        function removeCourse(url, table = null,id=null) {
            $.ajax({
                url: url,
                type: 'POST',
                // type: 'DELETE',
                data: {
                    'id': id,
                    '_token': '{{ csrf_token() }}',
                },
                // headers: {
                //     'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                // },
                beforeSend: function() {
                    showLoading();
                },
                success: function(response, status, xhr) {
                    if (xhr.status === 200) {
                        flasher.success(response.message);
                        if (table) {
                            table.ajax.reload();
                        }
                    } else if (xhr.status === 203) {
                        flasher.warning('You cannot change logged user details.');
                    } else {
                        flasher.error("Internal server error.");
                    }
                },
                error: function(xhr) {
                    flasher.error("Internal Server Error.");
                },
                complete: function() {
                    hideLoading();
                }
            });
        }


        // document.addEventListener("DOMContentLoaded", function() {
        //     var deleteButtons = document.querySelectorAll(".delete-btn");

        //     deleteButtons.forEach(function(button) {
        //         button.addEventListener("click", function(event) {
        //             var confirmDelete = window.confirm("Are you sure you want to delete?");

        //             if (!confirmDelete) {
        //                 event.preventDefault();
        //             }
        //         });
        //     });
        // });
    </script>
    <!-- Github buttons -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="{{ asset('assets') }}/js/material-dashboard.min.js?v=3.0.0"></script>

</body>

</html>
